"""
Making volcano plots
"""
import pickle
from scipy.interpolate import interp1d
from edl import models
from edl import constants as C


# log [Cat], log |j|, phi vs. RHE, gamma, pH
DATA_LI_11 = [
    (-2.2944444444444443, -3.293388429752066, -0.35, 11),
    (-1.6, -2.93801652892562, -0.35, 7, 11),
    (-1.2999999999999998, -2.731404958677686, -0.35, 11),
    (-1.0055555555555555, -2.475206611570248, -0.35, 11),
    (-1.0055555555555555, -2.6487603305785123, -0.30, 11),
    (-1.2999999999999998, -2.8801652892561984, -0.30, 11),
    (-1.6, -3.0785123966942147, -0.30, 7, 11),
    (-2.2944444444444443, -3.4338842975206614, -0.30, 11),
    (-2.2888888888888888, -3.615702479338843, -0.25, 11),
    (-1.6055555555555556, -3.2520661157024793, -0.25, 11),
    (-1.2999999999999998, -3.0867768595041323, -0.25, 11),
    (-1.0055555555555555, -2.871900826446281, -0.25, 11),
    (-1.0055555555555555, -3.1611570247933884, -0.20, 11),
    (-1.2999999999999998, -3.37603305785124, -0.20, 11),
    (-1.6055555555555556, -3.4834710743801653, -0.20, 11),
    (-2.2944444444444443, -3.847107438016529, -0.20, 11),
]
DATA_LI_13 = [
    (-2.297752808988764, -2.152892561983471, -0.35, 13),
    (-1.601123595505618, -1.9132231404958677, -0.35, 13),
    (-1.303370786516854, -1.7727272727272725, -0.35, 13),
    (-1, -1.549586776859504, -0.35, 13),
    (-0.9943820224719102, -1.8884297520661155, -0.30, 13),
    (-1.3089887640449438, -2.012396694214876, -0.30, 13),
    (-1.601123595505618, -2.1115702479338845, -0.30, 13),
    (-2.308988764044944, -2.2851239669421486, -0.30, 13),
    (-2.308988764044944, -2.4421487603305785, -0.25, 13),
    (-1.595505617977528, -2.309917355371901, -0.25, 13),
    (-1.297752808988764, -2.1942148760330578, -0.25, 13),
    (-0.9943820224719102, -2.1198347107438016, -0.25, 13),
    (-0.9943820224719102, -2.384297520661157, -0.20, 13),
    (-1.2921348314606742, -2.4421487603305785, -0.20, 13),
    (-1.595505617977528, -2.5165289256198347, -0.20, 13),
    (-2.303370786516854, -2.6404958677685952, -0.20, 13),
]
DATA_K_9 = [
    (-2.303370786516854, -2.848101265822785, -0.35, 9),
    (-1.606741573033708, -2.632911392405063, -0.35, 9),
    (-1.3146067415730338, -2.569620253164557, -0.35, 9),
    (-1, -3.1772151898734178, -0.35, 9),
    (-2.303370786516854, -2.9873417721518987, -0.30, 9),
    (-1.601123595505618, -2.8607594936708862, -0.30, 9),
    (-1.2921348314606742, -2.7848101265822787, -0.30, 9),
    (-0.9943820224719102, -3.5443037974683547, -0.30, 9),
    (-2.308988764044944, -3.1772151898734178, -0.25, 9),
    (-1.303370786516854, -3.050632911392405, -0.25, 9),
    (-0.9943820224719102, -3.6962025316455698, -0.25, 9),
    (-1.606741573033708, -3.0759493670886076, -0.25, 9),
    (-2.303370786516854, -3.4177215189873418, -0.20, 9),
    (-1.606741573033708, -3.3797468354430378, -0.20, 9),
    (-1.303370786516854, -3.3544303797468356, -0.20, 9),
    (-1, -3.810126582278481, -0.20, 9),
]
DATA_K_10 = [
    (-2.308988764044944, -4.144, -0.35, 10),
    (-1.601123595505618, -3.872, -0.35, 10),
    (-1.297752808988764, -3.856, -0.35, 10),
    (-0.9943820224719102, -4.010666666666666, -0.35, 10),
    (-2.303370786516854, -4.181333333333333, -0.30, 10),
    (-1.601123595505618, -3.8933333333333335, -0.30, 10),
    (-1.303370786516854, -3.8773333333333335, -0.30, 10),
    (-0.9887640449438202, -4.037333333333334, -0.30, 10),
    (-2.292134831460674, -4.245333333333333, -0.25, 10),
    (-1.595505617977528, -3.904, -0.25, 10),
    (-1.297752808988764, -3.9093333333333335, -0.25, 10),
    (-0.9943820224719102, -4.08, -0.25, 10),
    (-2.308988764044944, -4.357333333333333, -0.20, 10),
    (-1.595505617977528, -3.978666666666667, -0.20, 10),
    (-1.297752808988764, -3.978666666666667, -0.20, 10),
    (-1, -4.1866666666666665, -0.20, 10),
]
DATA_K_11 = [
    (-2.303370786516854, -2.4885496183206106, -0.45, 11),
    (-1.606741573033708, -2.9923664122137406, -0.45, 11),
    (-1.3089887640449438, -3.2519083969465647, -0.45, 11),
    (-0.9943820224719102, -3.572519083969466, -0.45, 11),
    (-2.303370786516854, -2.8091603053435117, -0.40, 11),
    (-1.606741573033708, -3.236641221374046, -0.40, 11),
    (-1.303370786516854, -3.5877862595419847, -0.40, 11),
    (-1, -3.8931297709923665, -0.40, 11),
    (-2.308988764044944, -3.068702290076336, -0.35, 11),
    (-1.606741573033708, -3.66412213740458, -0.35, 11),
    (-1.297752808988764, -4.122137404580153, -0.35, 11),
    (-0.9943820224719102, -4.396946564885496, -0.35, 11),
    (-2.303370786516854, -3.3893129770992365, -0.30, 11),
    (-1.601123595505618, -4.0458015267175576, -0.30, 11),
    (-1.303370786516854, -4.549618320610687, -0.30, 11),
    (-1, -4.793893129770993, -0.30, 11),
]
DATA_K_12 = [
    (-2.299256505576208, -1.6211180124223603, -0.45, 12),
    (-1.6022304832713754, -2.1677018633540373, -0.45, 12),
    (-1.3011152416356877, -2.6149068322981366, -0.45, 12),
    (-1, -3.111801242236025, -0.45, 12),
    (-2.299256505576208, -1.8322981366459627, -0.40, 12),
    (-1.6022304832713754, -2.3540372670807455, -0.40, 12),
    (-1.3011152416356877, -2.751552795031056, -0.40, 12),
    (-0.9944237918215615, -3.2236024844720497, -0.40, 12),
    (-2.299256505576208, -1.9813664596273293, -0.35, 12),
    (-1.5910780669144982, -2.5652173913043477, -0.35, 12),
    (-1.3066914498141264, -2.9130434782608696, -0.35, 12),
    (-1, -3.3850931677018634, -0.35, 12),
    (-2.3048327137546467, -2.1055900621118013, -0.30, 12),
    (-1.6022304832713754, -2.8260869565217392, -0.30, 12),
    (-1.3011152416356877, -3.0745341614906834, -0.30, 12),
    (-0.9944237918215615, -3.559006211180124, -0.30, 12),
]


curr_li_11 = [point[1] for point in DATA_LI_11]
efield_li_11 = []

curr_li_13 = [point[1] for point in DATA_LI_13]
efield_li_13 = []

curr_k_9 = [point[1] for point in DATA_K_9]
efield_k_9 = []

curr_k_10 = [point[1] for point in DATA_K_10]
efield_k_10 = []

curr_k_11 = [point[1] for point in DATA_K_11]
efield_k_11 = []

curr_k_12 = [point[1] for point in DATA_K_12]
efield_k_12 = []

datas = [DATA_LI_11, DATA_LI_13, DATA_K_9, DATA_K_10, DATA_K_11, DATA_K_12]
efields = [
    efield_li_11,
    efield_li_13,
    efield_k_9,
    efield_k_10,
    efield_k_11,
    efield_k_12,
]
currents = [
    curr_li_11,
    curr_li_13,
    curr_k_9,
    curr_k_10,
    curr_k_11,
    curr_k_12,
]
names = [
    r"Li$^+$ pH 11",
    r"Li$^+$ pH 13",
    r"K$^+$ pH 9",
    r"K$^+$ pH 10",
    r"K$^+$ pH 11",
    r"K$^+$ pH 12",
]
gammas = [7, 7, 5, 5, 5, 5]

for dataset, efield_list, gamma in zip(datas, efields, gammas):
    for point in dataset:

        def _get_rp_qty(sol, qty: str):
            phi_func = interp1d(sol["x"], sol[qty])
            return phi_func(C.D_ADSORBATE_LAYER * 1e9)

        model = models.AqueousVariableStern(10 ** point[0], gamma, 2, 4, 1)
        sol = model.spatial_profiles(
            phi0=point[2] - C.PT_PZC_SHE_V - 59e-3 * point[3],
            p_h=point[3],
            tol=1e-4,
        )
        # efield_list.append(sol["efield"][0])
        efield_list.append(sol["phi"][0] - _get_rp_qty(sol, "phi"))
        # efield_list.append(_get_rp_qty(sol, "phi"))


with open("pt_data_drivingforce.pickle", "wb") as f:
    pickle.dump((efields, currents, names), f)
