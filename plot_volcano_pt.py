"""
Making volcano plots
"""

import matplotlib.pyplot as plt

from edl import models
from edl import constants as C
import plotting as P

from matplotlib import rcParams

from edl import models

rcParams["lines.linewidth"] = 0.75
rcParams["font.size"] = 8
rcParams["axes.linewidth"] = 0.5
rcParams["xtick.major.width"] = 0.5
rcParams["ytick.major.width"] = 0.5

# log [Cat], log |j|, phi vs. RHE, gamma, pH
data_Li_11 = [
    (-2.2944444444444443, -3.293388429752066, -0.35, 11),
    (-1.6, -2.93801652892562, -0.35, 7, 11),
    (-1.2999999999999998, -2.731404958677686, -0.35, 11),
    (-1.0055555555555555, -2.475206611570248, -0.35, 11),
    (-1.0055555555555555, -2.6487603305785123, -0.30, 11),
    (-1.2999999999999998, -2.8801652892561984, -0.30, 11),
    (-1.6, -3.0785123966942147, -0.30, 7, 11),
    (-2.2944444444444443, -3.4338842975206614, -0.30, 11),
    (-2.2888888888888888, -3.615702479338843, -0.25, 11),
    (-1.6055555555555556, -3.2520661157024793, -0.25, 11),
    (-1.2999999999999998, -3.0867768595041323, -0.25, 11),
    (-1.0055555555555555, -2.871900826446281, -0.25, 11),
    (-1.0055555555555555, -3.1611570247933884, -0.20, 11),
    (-1.2999999999999998, -3.37603305785124, -0.20, 11),
    (-1.6055555555555556, -3.4834710743801653, -0.20, 11),
    (-2.2944444444444443, -3.847107438016529, -0.20, 11),
]
data_Li_13 = [
    (-2.297752808988764, -2.152892561983471, -0.35, 13),
    (-1.601123595505618, -1.9132231404958677, -0.35, 13),
    (-1.303370786516854, -1.7727272727272725, -0.35, 13),
    (-1, -1.549586776859504, -0.35, 13),
    (-0.9943820224719102, -1.8884297520661155, -0.30, 13),
    (-1.3089887640449438, -2.012396694214876, -0.30, 13),
    (-1.601123595505618, -2.1115702479338845, -0.30, 13),
    (-2.308988764044944, -2.2851239669421486, -0.30, 13),
    (-2.308988764044944, -2.4421487603305785, -0.25, 13),
    (-1.595505617977528, -2.309917355371901, -0.25, 13),
    (-1.297752808988764, -2.1942148760330578, -0.25, 13),
    (-0.9943820224719102, -2.1198347107438016, -0.25, 13),
    (-0.9943820224719102, -2.384297520661157, -0.20, 13),
    (-1.2921348314606742, -2.4421487603305785, -0.20, 13),
    (-1.595505617977528, -2.5165289256198347, -0.20, 13),
    (-2.303370786516854, -2.6404958677685952, -0.20, 13),
]
data_K_9 = [
    (-2.303370786516854, -2.848101265822785, -0.35, 9),
    (-1.606741573033708, -2.632911392405063, -0.35, 9),
    (-1.3146067415730338, -2.569620253164557, -0.35, 9),
    (-1, -3.1772151898734178, -0.35, 9),
    (-2.303370786516854, -2.9873417721518987, -0.30, 9),
    (-1.601123595505618, -2.8607594936708862, -0.30, 9),
    (-1.2921348314606742, -2.7848101265822787, -0.30, 9),
    (-0.9943820224719102, -3.5443037974683547, -0.30, 9),
    (-2.308988764044944, -3.1772151898734178, -0.25, 9),
    (-1.303370786516854, -3.050632911392405, -0.25, 9),
    (-0.9943820224719102, -3.6962025316455698, -0.25, 9),
    (-1.606741573033708, -3.0759493670886076, -0.25, 9),
    (-2.303370786516854, -3.4177215189873418, -0.20, 9),
    (-1.606741573033708, -3.3797468354430378, -0.20, 9),
    (-1.303370786516854, -3.3544303797468356, -0.20, 9),
    (-1, -3.810126582278481, -0.20, 9),
]
data_K_10 = [
    (-2.308988764044944, -4.144, -0.35, 10),
    (-1.601123595505618, -3.872, -0.35, 10),
    (-1.297752808988764, -3.856, -0.35, 10),
    (-0.9943820224719102, -4.010666666666666, -0.35, 10),
    (-2.303370786516854, -4.181333333333333, -0.30, 10),
    (-1.601123595505618, -3.8933333333333335, -0.30, 10),
    (-1.303370786516854, -3.8773333333333335, -0.30, 10),
    (-0.9887640449438202, -4.037333333333334, -0.30, 10),
    (-2.292134831460674, -4.245333333333333, -0.25, 10),
    (-1.595505617977528, -3.904, -0.25, 10),
    (-1.297752808988764, -3.9093333333333335, -0.25, 10),
    (-0.9943820224719102, -4.08, -0.25, 10),
    (-2.308988764044944, -4.357333333333333, -0.20, 10),
    (-1.595505617977528, -3.978666666666667, -0.20, 10),
    (-1.297752808988764, -3.978666666666667, -0.20, 10),
    (-1, -4.1866666666666665, -0.20, 10),
]
data_K_11 = [
    (-2.303370786516854, -2.4885496183206106, -0.45, 11),
    (-1.606741573033708, -2.9923664122137406, -0.45, 11),
    (-1.3089887640449438, -3.2519083969465647, -0.45, 11),
    (-0.9943820224719102, -3.572519083969466, -0.45, 11),
    (-2.303370786516854, -2.8091603053435117, -0.40, 11),
    (-1.606741573033708, -3.236641221374046, -0.40, 11),
    (-1.303370786516854, -3.5877862595419847, -0.40, 11),
    (-1, -3.8931297709923665, -0.40, 11),
    (-2.308988764044944, -3.068702290076336, -0.35, 11),
    (-1.606741573033708, -3.66412213740458, -0.35, 11),
    (-1.297752808988764, -4.122137404580153, -0.35, 11),
    (-0.9943820224719102, -4.396946564885496, -0.35, 11),
    (-2.303370786516854, -3.3893129770992365, -0.30, 11),
    (-1.601123595505618, -4.0458015267175576, -0.30, 11),
    (-1.303370786516854, -4.549618320610687, -0.30, 11),
    (-1, -4.793893129770993, -0.30, 11),
]
data_K_12 = [
    (-2.299256505576208, -1.6211180124223603, -0.45, 12),
    (-1.6022304832713754, -2.1677018633540373, -0.45, 12),
    (-1.3011152416356877, -2.6149068322981366, -0.45, 12),
    (-1, -3.111801242236025, -0.45, 12),
    (-2.299256505576208, -1.8322981366459627, -0.40, 12),
    (-1.6022304832713754, -2.3540372670807455, -0.40, 12),
    (-1.3011152416356877, -2.751552795031056, -0.40, 12),
    (-0.9944237918215615, -3.2236024844720497, -0.40, 12),
    (-2.299256505576208, -1.9813664596273293, -0.35, 12),
    (-1.5910780669144982, -2.5652173913043477, -0.35, 12),
    (-1.3066914498141264, -2.9130434782608696, -0.35, 12),
    (-1, -3.3850931677018634, -0.35, 12),
    (-2.3048327137546467, -2.1055900621118013, -0.30, 12),
    (-1.6022304832713754, -2.8260869565217392, -0.30, 12),
    (-1.3011152416356877, -3.0745341614906834, -0.30, 12),
    (-0.9944237918215615, -3.559006211180124, -0.30, 12),
]

currents_Li_11 = [point[1] for point in data_Li_11]
efield_Li_11 = []
pressure_Li_11 = []

currents_Li_13 = [point[1] for point in data_Li_13]
efield_Li_13 = []
pressure_Li_13 = []

currents_K_9 = [point[1] for point in data_K_9]
efield_K_9 = []
pressure_K_9 = []

currents_K_10 = [point[1] for point in data_K_10]
efield_K_10 = []
pressure_K_10 = []

currents_K_11 = [point[1] for point in data_K_11]
efield_K_11 = []
pressure_K_11 = []

currents_K_12 = [point[1] for point in data_K_12]
efield_K_12 = []
pressure_K_12 = []

datas = [data_Li_11, data_Li_13, data_K_9, data_K_10, data_K_11, data_K_12]
efields = [
    efield_Li_11,
    efield_Li_13,
    efield_K_9,
    efield_K_10,
    efield_K_11,
    efield_K_12,
]
pressures = [
    pressure_Li_11,
    pressure_Li_13,
    pressure_K_9,
    pressure_K_10,
    pressure_K_11,
    pressure_K_12,
]
gammas = [7, 7, 6, 6, 6, 6]

for dataset, efield_list, pressure_list, gamma in zip(
    datas, efields, pressures, gammas
):
    for point in dataset:
        model = models.AqueousVariableStern(10 ** point[0], gamma, 2, 4, 1)
        sol = model.spatial_profiles(
            phi0=point[2] - C.AU_PZC_SHE_V - 59e-3 * point[3], p_h=point[3], tol=1e-4
        )
        efield0 = sol["efield"].values[0]
        # phi_rp = point[2] - 59e-3 * point[3] - efield0 * C.D_ADSORBATE_LAYER
        # efield_list.append(efield0 * 1e-9)
        efield_list.append(efield0 * 1e-9)
        pressure_list.append(sol["pressure"].values[0] * 1e-5)

fig = plt.figure(figsize=(5, 4))
ax1 = fig.add_subplot()
# ax2 = fig.add_subplot(212)

colors = P.get_color_gradient(len(efields) - 1)

ax1.plot(efield_Li_11, currents_Li_11, ".", color="gray", label=r"Li$^+$ pH 11")
ax1.plot(efield_Li_13, currents_Li_13, ".", color="black", label=r"Li$^+$ pH 13")
ax1.plot(efield_K_9, currents_K_9, ".", color="tab:red", label=r"K$^+$ pH 9")
ax1.plot(efield_K_10, currents_K_10, ".", color="tab:green", label=r"K$^+$ pH 10")
ax1.plot(efield_K_11, currents_K_11, ".", color="tab:blue", label=r"K$^+$ pH 11")
ax1.plot(efield_K_12, currents_K_12, ".", color="tab:purple", label=r"K$^+$ pH 12")

ax1.set_xlabel(r"$E$ / V nm$^{-1}$")
ax1.set_xlim([-4.5, -2.5])
ax1.set_ylabel(r"log $|j|$ / A cm$^{-2}$")
ax1.legend(fancybox=False)

# ax2.plot(pressure_Li_11, currents_Li_11, ".", color="gray", label=r"Li$^+$ pH 11")
# ax2.plot(pressure_Li_13, currents_Li_13, ".", color="black", label=r"Li$^+$ pH 13")
# ax2.plot(pressure_K_9, currents_K_9, ".", color=colors[0], label=r"K$^+$ pH 9")
# ax2.plot(pressure_K_10, currents_K_10, ".", color=colors[1], label=r"K$^+$ pH 10")
# ax2.plot(pressure_K_11, currents_K_11, ".", color=colors[2], label=r"K$^+$ pH 11")
# ax2.plot(pressure_K_12, currents_K_12, ".", color=colors[3], label=r"K$^+$ pH 12")

# ax2.set_xlabel(r"$P$ / $10^5$ bar")
# ax2.set_ylabel(r"log $|j|$ / A cm$^{-2}$")
# ax2.legend(frameon=False)

plt.tight_layout()
plt.savefig("figures/res-pt-volcano.pdf")

plt.show()
